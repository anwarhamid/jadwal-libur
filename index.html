<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Penjadwalan Profesional 2026</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        :root {
            /* Palet Warna Profesional */
            --bg-body: #f0f2f5;
            --nav-bg: #1e293b; /* Slate Dark */
            --card-bg: #ffffff;
            --text-main: #334155;
            --primary: #3b82f6; /* Blue Accent */
            --accent-hover: #dbeafe;
            
            /* Warna Karyawan Tetap Sesuai Identitas */
            --anwar: #6d1b31; 
            --kezia: #a020f0; 
            --alfrian: #eab308; /* Yellow Gold */
            --grazica: #f97316; /* Orange */
            --mulya: #06b6d4;   /* Cyan */
        }

        body { 
            font-family: 'Inter', 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            background: var(--bg-body); 
            color: var(--text-main);
        }

        /* Navigation yang Lebih Rapi */
        nav { 
            background: var(--nav-bg); 
            color: white; 
            display: flex; 
            padding: 0 40px; 
            position: sticky; 
            top: 0; 
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        nav div { 
            padding: 18px 25px; 
            cursor: pointer; 
            font-weight: 500;
            font-size: 14px;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            opacity: 0.8;
        }
        nav div:hover { opacity: 1; background: rgba(255,255,255,0.05); }
        nav div.active { 
            opacity: 1; 
            border-bottom: 4px solid var(--primary); 
            background: rgba(255,255,255,0.1); 
        }

        .view { display: none; padding: 30px; max-width: 1400px; margin: 0 auto; }
        .view.active { display: block; animation: fadeIn 0.4s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Panel Kontrol Horizontal */
        .header-panel { 
            background: var(--card-bg); 
            padding: 25px; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.04); 
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }
        .header-panel h3 { margin: 0 0 20px 0; font-size: 18px; font-weight: 600; color: #1e293b; }
        
        .employee-list-horizontal { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; }

        .opt { 
            display: flex; align-items: center; padding: 10px 20px; 
            border-radius: 12px; cursor: pointer; border: 1.5px solid #f1f5f9; 
            background: #fff; font-size: 14px; font-weight: 600; 
            transition: all 0.2s ease;
            color: #64748b;
        }
        .opt:hover { background: var(--accent-hover); border-color: var(--primary); }
        .opt.active { 
            border-color: var(--primary); 
            background: var(--accent-hover); 
            color: var(--primary);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        .dot { width: 14px; height: 14px; border-radius: 4px; margin-right: 10px; }
        
        /* Kalender Grid Responsif */
        .calendar-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); 
            gap: 25px; 
        }
        .month-box { 
            background: var(--card-bg); 
            border-radius: 16px; 
            overflow: hidden; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            border: 1px solid #e2e8f0;
        }
        .month-title { 
            background: #f8fafc; 
            color: #1e293b; 
            text-align: center; 
            padding: 15px 20px; 
            font-weight: 700; 
            border-bottom: 1px solid #e2e8f0;
            font-size: 16px;
        }
        .days { display: grid; grid-template-columns: repeat(7, 1fr); }
        .day-lbl { 
            color: #94a3b8; 
            font-size: 11px; 
            padding: 12px 0; 
            font-weight: 800; 
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
        }
        
        /* Sel Tanggal */
        .day { 
            aspect-ratio: 1/1; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; 
            border: 0.5px solid #f1f5f9; cursor: pointer; 
            transition: background 0.2s;
        }
        .day:hover { background: #f8fafc; }
        .day span.date-num { font-size: 15px; font-weight: 500; }
        .day span.emp-name { font-size: 9px; font-weight: 700; text-transform: uppercase; margin-top: 4px; opacity: 0.9; }
        
        /* Warna Background dengan Text Kontras */
        .bg-anwar { background: var(--anwar) !important; color: white; }
        .bg-kezia { background: var(--kezia) !important; color: white; }
        .bg-alfrian { background: var(--alfrian) !important; color: #422006; }
        .bg-grazica { background: var(--grazica) !important; color: white; }
        .bg-mulya { background: var(--mulya) !important; color: #083344; }

        /* Dashboard */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; }
        .stat-card { 
            background: white; padding: 25px; border-radius: 16px; 
            text-align: center; border-left: 6px solid #ddd;
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }
        .stat-card h4 { color: #64748b; margin: 0 0 10px 0; font-size: 13px; letter-spacing: 1px; }
        .stat-card .count { font-size: 32px; font-weight: 800; color: #1e293b; }

        @media (max-width: 768px) { nav { padding: 0 10px; } .view { padding: 15px; } }
        /* Menambahkan indikator visual kecil di bawah angka untuk libur nasional */
        .day[title] .date-num::after {
            content: '•';
            display: block;
            font-size: 10px;
            line-height: 0;
        }
        /* Container untuk menampung label di bawah angka */
        .label-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-top: 2px;
        }

        /* Style khusus untuk label libur nasional */
        .holiday-label {
            font-size: 6px;
            color: red !important; /* Memaksa tetap merah */
            font-weight: bold;
            line-height: 1.1;
            text-align: center;
            margin-bottom: 2px;
        }

        /* Style khusus untuk label nama karyawan */
        .user-label {
            font-size: 8px;
            font-weight: 800;
            line-height: 1;
            text-align: center;
            color: inherit; /* Mengikuti warna teks utama dari class bg-xxx */
        }

        /* Pastikan warna teks label nama tetap putih pada background gelap */
        .bg-anwar .user-label, 
        .bg-kezia .user-label, 
        .bg-grazica .user-label {
            color: white !important;
        }

        /* Pastikan warna teks label nama tetap hitam pada background terang */
        .bg-alfrian .user-label, 
        .bg-mulya .user-label {
            color: #334155 !important;
        }

        /* Tambahan: Jika tanggal libur ada di background gelap, 
        buat label liburnya sedikit lebih terang agar tetap terbaca */
        .bg-anwar .holiday-label, 
        .bg-kezia .holiday-label {
            color: #ff8080 !important; 
        }
    </style>
</head>
<body>

    <nav>
        <div class="nav-item active" onclick="switchView('control-view')">PENJADWALAN</div>
        <div class="nav-item" onclick="switchView('dashboard-view')">DASHBOARD LAPORAN</div>
    </nav>

    <div id="control-view" class="view active">
        <div class="header-panel">
            <h3>Manajemen Libur Karyawan</h3>
            <div class="employee-list-horizontal">
                <div class="opt active" data-user="anwar"><span class="dot" style="background:var(--anwar)"></span> ANWAR</div>
                <div class="opt" data-user="kezia"><span class="dot" style="background:var(--kezia)"></span> KEZIA</div>
                <div class="opt" data-user="alfrian"><span class="dot" style="background:var(--alfrian)"></span> ALFRIAN</div>
                <div class="opt" data-user="grazica"><span class="dot" style="background:var(--grazica)"></span> GRAZICA</div>
                <div class="opt" data-user="mulya"><span class="dot" style="background:var(--mulya)"></span> MULYA</div>
                <div class="opt" data-user="none" style="border-style: dashed;">✕ Hapus</div>
            </div>
        </div>
        <div class="calendar-grid" id="calendar-container"></div>
    </div>

    <div id="dashboard-view" class="view">
        <div style="display:flex; justify-content: space-between; align-items:center; margin-bottom:30px; background: white; padding: 20px; border-radius: 12px;">
            <h2 style="margin:0; font-size: 20px;">Ringkasan Libur Bulanan</h2>
            <select id="filter-month" onchange="updateDashboard()" style="padding:10px 15px; border-radius:8px; border: 1px solid #e2e8f0; font-weight: 600;"></select>
        </div>
        <div class="stats-grid" id="stats-container"></div>
    </div>

    <script>
        // ISI CONFIG FIREBASE ANDA DI SINI
        const firebaseConfig = {
            apiKey: "AIzaSyAlzi3Egf-L9Fz0tE-YZLDDtAEWs97cAW4",
            authDomain: "jadwal-libur-f38db.firebaseapp.com",
            databaseURL: "https://jadwal-libur-f38db-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "jadwal-libur-f38db",
            storageBucket: "jadwal-libur-f38db.firebasestorage.app",
            messagingSenderId: "123733774698",
            appId: "1:123733774698:web:e3bf19d569d8831d7fd513",
            measurementId: "G-H3W268K4HG"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const months = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
        // Tambahkan data libur nasional 2026
        const nationalHolidays = {
            "2026-01-01": "New Year's Day",
            "2026-01-16": "Ascension of the Prophet Muhammad",
            "2026-02-17": "Chinese New Year's Day",
            "2026-03-19": "Nyepi (Hindu New Year)",
            "2026-03-20": "Idul Fitri Day 1",
            "2026-03-21": "Idul Fitri Day 2",
            "2026-04-03": "Good Friday",
            "2026-04-05": "Easter Sunday",
            "2026-05-01": "International Labor Day",
            "2026-05-14": "Ascension Day of Jesus Christ",
            "2026-05-27": "Idul Adha",
            "2026-05-31": "Waisak Day",
            "2026-06-01": "Pancasila Day",
            "2026-06-16": "Islamic New Year",
            "2026-08-17": "Indonesian Independence Day",
            "2026-08-25": "Maulid Nabi Muhammad",
            "2026-12-25": "Christmas Day"
        };
        const users = ["anwar", "kezia", "alfrian", "grazica", "mulya"];
        let selectedUser = "anwar";
        let allData = {};

        function switchView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            event.currentTarget.classList.add('active');
            if(viewId === 'dashboard-view') updateDashboard();
        }

        function renderCalendar() {
            const container = document.getElementById('calendar-container');
            container.innerHTML = '';
            for (let m = 0; m < 12; m++) {
                const box = document.createElement('div');
                box.className = 'month-box';
                box.innerHTML = `<div class="month-title">${months[m]} 2026</div>`;
                const daysDiv = document.createElement('div');
                daysDiv.className = 'days';
                ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"].forEach(d => daysDiv.innerHTML += `<div class="day-lbl">${d}</div>`);
                const firstDay = new Date(2026, m, 1).getDay();
                const totalDays = new Date(2026, m + 1, 0).getDate();
                for (let i = 0; i < firstDay; i++) daysDiv.innerHTML += `<div class="day empty"></div>`;
                for (let d = 1; d <= totalDays; d++) {
                    const dateId = `2026-${String(m+1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const dayEl = document.createElement('div');
                    dayEl.className = 'day';
                    
                    const userData = allData[dateId];
                    const holidayName = nationalHolidays[dateId]; 

                    // A. Atur Background jika dipilih karyawan
                    if (userData) {
                        dayEl.classList.add(`bg-${userData}`);
                    }

                    // B. Atur Warna Angka jika Libur Nasional
                    if (holidayName) {
                        dayEl.style.color = "red";
                        dayEl.style.fontWeight = "bold";
                        dayEl.title = holidayName; 
                    }

                    // C. Tampilkan keduanya secara bertumpuk (Stacked)
                    // Kita buat dua span terpisah agar tidak saling tindih
                    // Tampilkan Angka Tanggal (Merah jika libur) dan Label secara terpisah
                    dayEl.innerHTML = `
                        <span class="date-num" style="${holidayName ? 'color: red; font-weight: bold;' : ''}">${d}</span>
                        <div class="label-container">
                            ${holidayName ? `<span class="holiday-label">${holidayName}</span>` : ''}
                            ${userData ? `<span class="user-label">${userData.toUpperCase()}</span>` : ''}
                        </div>
                    `;
                    
                    dayEl.onclick = () => {
                        // ... (logika confirm dan kuota tetap seperti sebelumnya)
                    };
                    
                    daysDiv.appendChild(dayEl);
                }
                box.appendChild(daysDiv);
                container.appendChild(box);
            }
        }

        function updateDashboard() {
            const monthVal = document.getElementById('filter-month').value;
            const container = document.getElementById('stats-container');
            container.innerHTML = '';
            const counts = {};
            users.forEach(u => counts[u] = 0);
            Object.keys(allData).forEach(date => {
                if (date.startsWith(`2026-${monthVal}`)) {
                    const user = allData[date];
                    if (counts[user] !== undefined) counts[user]++;
                }
            });
            users.forEach(u => {
                const card = document.createElement('div');
                card.className = 'stat-card';
                card.style.borderLeftColor = `var(--${u})`;
                card.innerHTML = `<h4>${u.toUpperCase()}</h4><div class="count">${counts[u]}</div><small style="color:#94a3b8">HARI LIBUR</small>`;
                container.appendChild(card);
            });
        }

        function init() {
            const filterMonth = document.getElementById('filter-month');
            months.forEach((m, idx) => {
                filterMonth.innerHTML += `<option value="${String(idx+1).padStart(2, '0')}">${m}</option>`;
            });
            filterMonth.value = String(new Date().getMonth() + 1).padStart(2, '0');

            document.querySelectorAll('.opt').forEach(opt => {
                opt.onclick = function() {
                    document.querySelectorAll('.opt').forEach(o => o.classList.remove('active'));
                    this.classList.add('active');
                    selectedUser = this.dataset.user;
                };
            });

            db.ref('holidays').on('value', (snapshot) => {
                allData = snapshot.val() || {};
                renderCalendar();
                updateDashboard();
            });
        }
        init();
        
    </script>
</body>
</html>